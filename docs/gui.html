---

title: GUI


keywords: fastai
sidebar: home_sidebar



nb_path: "08_gui.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: 08_gui.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="App-design">App design<a class="anchor-link" href="#App-design"> </a></h2><p>So what zones do we need for a proper image search app? Two examples come to mind: <a href="https://same.energy">https://same.energy</a> and <a href="https://images.google.com">https://images.google.com</a>. One is minimalist and brutalist while the other is maximalist in features and refined in design.</p>
<p>Same.energy proves that all you need for image search is a text box, a button, and images. (At least, that's how it started off, and sometimes how it is today. They're A/B testing heavily right now, and we'll see what it evolves into.) If you click on an image result, you are now searching for that image. If you add text, it asks if you want to search for the image with text or just the image. This can lead in any hill-climbing direction the user wants, I suppose.</p>
<p>Google Images has up to six toolbars overhanging the images, and a complicated lightbox selection window that shows the individual image with a subset of similar images below it. Nested and stacked, providing lots of specific search and filtering capabilities. Not as likely to induce a wikiwalk. They've introduced "collections" now, which are presumably meant to replace the "download to random image folder" functionality of current browsers.</p>
<p>There's also Pinterest, of course, though their engineering is geared more toward gaming Google results than finding the right image by search. Thye have a great browse mode though, and save features. Best of all, they have a goodreads-style user tagging function that allows for a whole different way of sorting images than availableon the other sites.</p>
<p>The functions available from these sites include:</p>
<ul>
<li>Text query</li>
<li>Image query</li>
<li>Text and image query (totally doable with CLIP vectors)</li>
<li>Browse visually similar images</li>
<li>Save images (to cloud mostly)</li>
<li>Filter images by:<ul>
<li>Size</li>
<li>Color</li>
<li>Type</li>
<li>Time</li>
<li>Usage rights</li>
</ul>
</li>
<li>Visit homepage for image</li>
<li>Tagging images</li>
<li>Searching by tags additively</li>
<li>Filtering out by tags</li>
</ul>
<p>Tags and filter categories can both be simulated with CLIP vectors of text tokens like "green" or "noisy" or "illustration" or "menswear". Size of image can be inferred directly from filesize or recorded from bitmap data in the <a href="/memery/crafter.html#crafter"><code>crafter</code></a>. Images as search queries and visually similar image browser are the same function but in different user interaction modes. And image links can be to local files, rather than homepages. Saving images not as relevant in this context, though easily sending them somewhere else is.</p>
<p>Thus there are really three projects here:</p>
<ul>
<li>Basic app functionality with search and grid</li>
<li>Visually simillar image browsing and search</li>
<li>Tagging and filtering, auto and manual</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Basic-app-functionality">Basic app functionality<a class="anchor-link" href="#Basic-app-functionality"> </a></h2><p>We want a unified search bar (variable inputs and a button) and an image grid. And each search should remain accessible after it's run, so we can navigate between and compare. It would be nice to use browser-native navigation but for now, with the plan to run a notebook in Voila and serve locally, better to use <code>ipywidgets</code> Tabs mode. Eventually it would also be good to replace or upgrade <code>ipyplot</code> or better navigation, but first we should sketch out the new-tab functionality.</p>
<p>Need a tabs output, an event loop, a dictionary of searches run, each search returning a list of filenames to be printed in a sub-output within the tab. All wrapped in a VBox with the inputs.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">filepaths</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;images/Wholesome-Meme-8.jpg&#39;</span><span class="p">,</span> <span class="s1">&#39;images/Wholesome-Meme-1.jpg&#39;</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="get_image" class="doc_header"><code>get_image</code><a href="https://github.com/deepfates/memery/tree/main/memery/gui.py#L15" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_image</code>(<strong><code>file_loc</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">display</span><span class="p">(</span><span class="n">get_image</span><span class="p">(</span><span class="n">filepaths</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">imgs</span> <span class="o">=</span> <span class="p">[</span><span class="n">get_image</span><span class="p">(</span><span class="n">f</span><span class="p">)</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">filepaths</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="get_grid" class="doc_header"><code>get_grid</code><a href="https://github.com/deepfates/memery/tree/main/memery/gui.py#L22" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_grid</code>(<strong><code>filepaths</code></strong>, <strong><code>n</code></strong>=<em><code>4</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">get_grid</span><span class="p">(</span><span class="n">filepaths</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="update_tabs" class="doc_header"><code>update_tabs</code><a href="https://github.com/deepfates/memery/tree/main/memery/gui.py#L28" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>update_tabs</code>(<strong><code>path</code></strong>, <strong><code>query</code></strong>, <strong><code>n_images</code></strong>, <strong><code>searches</code></strong>, <strong><code>tabs</code></strong>, <strong><code>inputs</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="page_update" class="doc_header"><code>page_update</code><a href="https://github.com/deepfates/memery/tree/main/memery/gui.py#L44" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>page_update</code>(<strong><code>b</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">inputs_layout</span> <span class="o">=</span>  <span class="n">widgets</span><span class="o">.</span><span class="n">Layout</span><span class="p">(</span><span class="n">max_width</span><span class="o">=</span><span class="s1">&#39;80%&#39;</span><span class="p">)</span>

<span class="n">path</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">Text</span><span class="p">(</span><span class="n">placeholder</span><span class="o">=</span><span class="s1">&#39;path/to/image/folder&#39;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="s1">&#39;images/&#39;</span><span class="p">,</span> <span class="n">layout</span><span class="o">=</span><span class="n">inputs_layout</span><span class="p">)</span>
<span class="n">query</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">Text</span><span class="p">(</span><span class="n">placeholder</span><span class="o">=</span><span class="s1">&#39;a funny dog meme&#39;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="s1">&#39;a funny dog meme&#39;</span><span class="p">,</span> <span class="n">layout</span><span class="o">=</span><span class="n">inputs_layout</span><span class="p">)</span>

<span class="n">n_images</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">IntSlider</span><span class="p">(</span><span class="n">description</span><span class="o">=</span><span class="s1">&#39;#&#39;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">layout</span><span class="o">=</span><span class="n">inputs_layout</span><span class="p">)</span>
<span class="n">go</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="n">description</span><span class="o">=</span><span class="s2">&quot;Search&quot;</span><span class="p">,</span> <span class="n">layout</span><span class="o">=</span><span class="n">inputs_layout</span><span class="p">)</span>

<span class="n">all_inputs_layout</span> <span class="o">=</span>  <span class="n">widgets</span><span class="o">.</span><span class="n">Layout</span><span class="p">(</span><span class="n">max_width</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span><span class="p">,</span> <span class="n">flex_flow</span><span class="o">=</span><span class="s1">&#39;row wrap&#39;</span><span class="p">,</span> <span class="n">align_content</span><span class="o">=</span><span class="s1">&#39;flex-start&#39;</span><span class="p">)</span>

<span class="n">inputs</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">Box</span><span class="p">([</span><span class="n">path</span><span class="p">,</span> <span class="n">query</span><span class="p">,</span> <span class="n">n_images</span><span class="p">,</span> <span class="n">go</span><span class="p">,</span> <span class="p">],</span> <span class="n">layout</span><span class="o">=</span><span class="n">all_inputs_layout</span><span class="p">)</span>
<span class="n">tabs</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">Tab</span><span class="p">()</span>
<span class="n">page</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">AppLayout</span><span class="p">(</span><span class="n">left_sidebar</span><span class="o">=</span><span class="n">inputs</span><span class="p">,</span> <span class="n">center</span><span class="o">=</span><span class="n">tabs</span><span class="p">)</span>

<span class="n">searches</span> <span class="o">=</span> <span class="p">{}</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_text output_error">
<pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
<span class="ansi-green-fg">&lt;ipython-input-3-5dc6df7b5cec&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span>
<span class="ansi-green-fg">----&gt; 1</span><span class="ansi-red-fg"> </span>inputs_layout <span class="ansi-blue-fg">=</span>  widgets<span class="ansi-blue-fg">.</span>Layout<span class="ansi-blue-fg">(</span>max_width<span class="ansi-blue-fg">=</span><span class="ansi-blue-fg">&#39;80%&#39;</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">      2</span> 
<span class="ansi-green-intense-fg ansi-bold">      3</span> path <span class="ansi-blue-fg">=</span> widgets<span class="ansi-blue-fg">.</span>Text<span class="ansi-blue-fg">(</span>placeholder<span class="ansi-blue-fg">=</span><span class="ansi-blue-fg">&#39;path/to/image/folder&#39;</span><span class="ansi-blue-fg">,</span> value<span class="ansi-blue-fg">=</span><span class="ansi-blue-fg">&#39;images/&#39;</span><span class="ansi-blue-fg">,</span> layout<span class="ansi-blue-fg">=</span>inputs_layout<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">      4</span> query <span class="ansi-blue-fg">=</span> widgets<span class="ansi-blue-fg">.</span>Text<span class="ansi-blue-fg">(</span>placeholder<span class="ansi-blue-fg">=</span><span class="ansi-blue-fg">&#39;a funny dog meme&#39;</span><span class="ansi-blue-fg">,</span> value<span class="ansi-blue-fg">=</span><span class="ansi-blue-fg">&#39;a funny dog meme&#39;</span><span class="ansi-blue-fg">,</span> layout<span class="ansi-blue-fg">=</span>inputs_layout<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">      5</span> 

<span class="ansi-red-fg">NameError</span>: name &#39;widgets&#39; is not defined</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">go</span><span class="o">.</span><span class="n">on_click</span><span class="p">(</span><span class="n">page_update</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">out</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">Output</span><span class="p">(</span><span class="n">layout</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;width&quot;</span><span class="p">:</span><span class="s1">&#39;100%&#39;</span><span class="p">})</span>

<span class="k">with</span> <span class="n">out</span><span class="p">:</span>
    <span class="n">display</span><span class="p">(</span><span class="n">page</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">out</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="appPage" class="doc_header"><code>class</code> <code>appPage</code><a href="https://github.com/deepfates/memery/tree/main/memery/gui.py#L49" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>appPage</code>()</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">app</span> <span class="o">=</span> <span class="n">appPage</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">app</span><span class="o">.</span><span class="n">go</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Searching 78 images
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

</div>
 

