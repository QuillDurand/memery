---

title: Loader


keywords: fastai
sidebar: home_sidebar



nb_path: "01_loader.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: 01_loader.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="File-manipulation">File manipulation<a class="anchor-link" href="#File-manipulation"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="slugify" class="doc_header"><code>slugify</code><a href="https://github.com/deepfates/memery/tree/main/memery/loader.py#L9" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>slugify</code>(<strong><code>filepath</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="get_image_files" class="doc_header"><code>get_image_files</code><a href="https://github.com/deepfates/memery/tree/main/memery/loader.py#L12" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_image_files</code>(<strong><code>path</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">root</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s1">&#39;./images&#39;</span><span class="p">)</span>

<span class="n">filepaths</span> <span class="o">=</span> <span class="n">get_image_files</span><span class="p">(</span><span class="n">root</span><span class="p">)</span>

<span class="nb">len</span><span class="p">(</span><span class="n">filepaths</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>58</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">filepaths</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[(Path(&#34;images/I-hope-you-don&#39;t-mind-filipino-food.jpg&#34;),
  &#34;I-hope-you-don&#39;t-mind-filipino-food_1618714060&#34;),
 (Path(&#39;images/aliens-gatherings-with-yugoslav-folk-music-playing-in-background.jpg&#39;),
  &#39;aliens-gatherings-with-yugoslav-folk-music-playing-in-background_1618714041&#39;),
 (Path(&#39;images/cat-shitting-in-rice.jpg&#39;), &#39;cat-shitting-in-rice_1618714051&#39;)]</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Loaders">Loaders<a class="anchor-link" href="#Loaders"> </a></h2><p>So we have a list of paths and slugified filenames from the folder. We want to see if there's an archive, so that we don't have to recalculate tensors for images we've seen before. Then we want to pass that directly to the indexer, but send the new images through the crafter and encoder first.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>device(type=&#39;cuda&#39;)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="archive_loader" class="doc_header"><code>archive_loader</code><a href="https://github.com/deepfates/memery/tree/main/memery/loader.py#L25" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>archive_loader</code>(<strong><code>filepaths</code></strong>, <strong><code>root</code></strong>, <strong><code>device</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="db_loader" class="doc_header"><code>db_loader</code><a href="https://github.com/deepfates/memery/tree/main/memery/loader.py#L38" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>db_loader</code>(<strong><code>dbpath</code></strong>, <strong><code>device</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="treemap_loader" class="doc_header"><code>treemap_loader</code><a href="https://github.com/deepfates/memery/tree/main/memery/loader.py#L53" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>treemap_loader</code>(<strong><code>treepath</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">archive_db</span><span class="p">,</span> <span class="n">new_files</span> <span class="o">=</span> <span class="n">archive_loader</span><span class="p">(</span><span class="n">get_image_files</span><span class="p">(</span><span class="n">root</span><span class="p">),</span> <span class="n">root</span><span class="p">,</span> <span class="n">device</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">archive_db</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">new_files</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(0, 58)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

</div>
 

